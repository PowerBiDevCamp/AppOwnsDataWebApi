<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>App-Owns-Data Web API Client</title>
  <link href="~/lib/bootstrap/dist/css/bootstrap.css" rel="stylesheet" />
  <link href="~/css/app.css" rel="stylesheet" />
</head>
<body>

  <header id="banner">
    <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3">
      <div class="container">
        <a class="navbar-brand">App-Owns-Data Web API Client</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse d-sm-inline-flex flex-sm-row-reverse">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item"><a href="javascript:void(0)" class="nav-link"><span id="user-greeting"></a></li>
            <li class="nav-item"><a id="login" href="javascript:void(0)" class="nav-link">Login</a></li>
            <li class="nav-item"><a id="logout" href="javascript:void(0)" class="nav-link">Logout</a></li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <div class="container">
    <main role="main" class="pb-3">
      <div class='container-fluid'>
        <div id="view-anonymous" class="row">
          <div class="jumbotron" style="width: 100%;">
            <h1>Welcome to the App-Owns-Data Web API Sample Application</h1>
            <div>This sample application has been implemented as a Single Page Application (SPA) using HTML, CSS and TypeScript.
              After authenticating with Azure AD, the app is able to make authenticated calls the custom web API named AppOwnsDataWebApi to get the data and embed tokens
              required to embed reports in the browser. Click on the login link in the upper right to get started.
            </div>
          </div>
        </div>
        <div id="loading-spinner-row" class="row" style="display:none">
          <div id="loading-spinner-container" class="justify-content-center">
            <div class="spinner-border" style="width: 10rem; height: 10rem; color: #222222;" role="status">
              <span class="sr-only">Loading...</span>
            </div>
          </div>
        </div>
        <div id="view-authenticated" class='row' style="display: none;">
          <div id="left-nav" class='col-sm-2'>
            <div>
              <div class='navbar-header'>
                Current Workspace
              </div>
              <div id="workspace-selector-dropdown" class="dropdown">
                <button id="workspace-selector" class="btn btn-sm dropdown-toggle" style="width: 100%;" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Select Workspace
                </button>
                <div id="workspaces-list" class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                </div>
              </div>
              <div class='navbar-header navbar-toggle' data-toggle='collapse' data-target='.reports-collapse'>
                Reports
              </div>
              <div id='reports-menu' class='navbar-collapse reports-collapse'>
                <ul id='reports-list' class='nav navbar-nav'></ul>
              </div>
              <div class='navbar-header navbar-toggle' data-toggle='collapse' data-target='.datasets-collapse'>
                Datasets
              </div>
              <div id='datasets-menu' class='navbar-collapse datasets-collapse'>
                <ul id='datasets-list' class='nav navbar-nav'></ul>
              </div>
            </div>
          </div>
          <div id="content-box" class='col-sm-10'>
            <div id="embedding-instructions">
              <h2>Embed a Report</h2>
              <ul>
                <li>Use the workspace selector menu to choose a workspace.</li>
                <li>Click on an existing report to embed it.</li>
                <li>Click on an existing dataset to create a new report.</li>
              </ul>
            </div>
            <div id="embed-toolbar" role="toolbar" style="display:none">
              <span id="breadcrumb">&nbsp;</span>
              <button type="button" id="full-screen" class="btn btn-sm ">Full Screen</button>
              <button type="button" id="toggle-edit" class="btn btn-sm ">Toggle Edit Mode</button>
            </div>
            <div id="embed-container"></div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script type="text/javascript" src="~/js/bundle.js"></script>

</body>
</html>

